---
title: "Claude Code 実践Tips 2：自己検証の仕組みを与える"
emoji: "✅"
type: "tech"
topics: ["claudecode", "ai", "生成ai", "llm", "個人開発"]
published: false
---

## はじめに

Claudeにコードを書いてもらった。「完成しました」と言われた。

でも、本当に動くのか？

自分で確認するしかない...と思っていないだろうか。

実は、**Claudeに「自分で確認させる」ことができる**。そしてこれが、精度を劇的に上げる方法だ。

Anthropic公式のベストプラクティスには、こう書かれている。

> **これは、あなたができる最もレバレッジの高いことだ。Claudeは自分の作業を検証できる時、劇的に良いパフォーマンスを発揮する。**

この記事では、Claudeに「自己検証」させる方法を解説する。

:::message
**シリーズ構成**
1. [コンテキスト管理が全ての土台](claude-code-context-management)
2. **自己検証の仕組みを与える**（この記事）
3. [CLAUDE.md活用術](claude-code-claude-md)（準備中）
4. [効果的なプロンプト術](claude-code-effective-prompts)（準備中）
5. [サブエージェント活用術](claude-code-subagents)（準備中）
:::

---

## なぜ自己検証が重要なのか

### 検証なしの場合

```
あなた：「メールアドレスを検証する関数を作って」
Claude：「作りました」
あなた：（本当に動くか分からない...）
あなた：（自分でテストしないと...）
```

Claudeは「それっぽいコード」を書くのは得意だが、**実際に動くかどうか**は別問題。あなたが唯一のフィードバックループになってしまう。

### 検証ありの場合

```
あなた：「メールアドレスを検証する関数を作って。
        user@example.com は true、
        invalid は false、
        user@.com は false になることを確認して」
Claude：「作りました。テストを実行して確認します」
Claude：「3つのケース全て通りました」
```

Claudeが自分で確認してくれるので、あなたは結果だけ見ればいい。

---

## 検証の3つのパターン

### パターン1：テストケースを与える

最もシンプルな方法。期待する入力と出力を伝える。

**Before（検証なし）**
```
メールアドレスを検証する関数を作って
```

**After（検証あり）**
```
メールアドレスを検証する関数を作って。

テストケース：
- user@example.com → true
- invalid → false
- user@.com → false

実装後にテストを実行して確認して
```

:::message
**ポイント**
「実装後にテストを実行して確認して」を必ず入れる。これがないと、Claudeはコードを書いて終わりにしてしまう。
:::

### パターン2：スクリーンショットで確認させる

UI（見た目）の変更は、スクリーンショットで確認させる。

**Before（検証なし）**
```
ダッシュボードの見た目を良くして
```

**After（検証あり）**
```
[スクリーンショットを貼り付け]

このデザインを実装して。
実装後にスクリーンショットを撮って、元のデザインと比較して。
違いがあればリストアップして修正して。
```

:::message
**Chrome拡張を使う場合**
Claude Code の Chrome 拡張を使うと、ブラウザを開いてUIをテストし、自動で修正を繰り返すことができる。
:::

### パターン3：根本原因を解決させる

エラーを報告する時は、「直して」ではなく「根本原因を解決して」と伝える。

**Before（症状だけ）**
```
ビルドが失敗する
```

**After（根本原因を求める）**
```
ビルドが以下のエラーで失敗する：

[エラーメッセージを貼り付け]

直して、ビルドが成功することを確認して。
エラーを抑制するのではなく、根本原因に対処して。
```

:::message alert
**「エラーを抑制するな」が重要**
これを言わないと、Claudeはエラーメッセージを非表示にしたり、`// @ts-ignore` を追加したりして「見かけ上」直そうとすることがある。
:::

---

## 具体例：Before / After 比較

公式ドキュメントから、効果的な指示の例を紹介する。

### 例1：関数の実装

| Before | After |
|--------|-------|
| メールアドレスを検証する関数を作って | validateEmail関数を作って。テストケース：user@example.com は true、invalid は false、user@.com は false。実装後にテストを実行して |

### 例2：UIの変更

| Before | After |
|--------|-------|
| ダッシュボードの見た目を良くして | [スクリーンショット] このデザインを実装して。結果のスクリーンショットを撮って比較し、違いをリストアップして修正して |

### 例3：バグ修正

| Before | After |
|--------|-------|
| ビルドが失敗する | ビルドがこのエラーで失敗する：[エラー]。直してビルドが成功することを確認して。エラーを抑制せず根本原因に対処して |

---

## 検証手段を用意する

Claudeが検証できるようにするには、**検証手段**が必要。

### テストスイート

既存のテストがあれば、それを使わせる。

```
変更後に npm test を実行して、全てのテストが通ることを確認して
```

### リンター（コード品質チェック）

```
変更後に npm run lint を実行して、エラーがないことを確認して
```

### 型チェック

```
変更後に tsc --noEmit を実行して、型エラーがないことを確認して
```

### カスタムスクリプト

特定の条件をチェックするスクリプトを作っておく。

```
変更後に npm run check-api-response を実行して、
レスポンスが期待通りかを確認して
```

---

## 検証を習慣化する

### CLAUDE.md に書いておく

毎回「テストを実行して」と言うのが面倒なら、CLAUDE.md に書いておく。

```markdown
# ワークフロー
- コード変更後は必ず `npm test` を実行して確認すること
- UIの変更後はスクリーンショットを撮って確認すること
```

CLAUDE.mdについては、第3部で詳しく解説する。

### カスタムコマンドにする

よく使う検証フローをコマンド化する。

ファイル：`.claude/commands/verify.md`
```markdown
---
description: 変更を検証する
---

以下の検証を実行してください：
1. npm run lint（コード品質）
2. npm run typecheck（型チェック）
3. npm test（テスト）

全て通ったら「検証完了」と報告してください。
エラーがあれば修正してから再度検証してください。
```

使い方：
```
/verify
```

---

## 検証できない場合

テストがない、検証手段がないプロジェクトもある。

その場合は、**手動で確認するポイントをCloudeに列挙させる**。

```
変更を完了したら、手動で確認すべきポイントをリストアップして
```

Claudeが「ここをクリックして、こうなれば成功」というチェックリストを作ってくれる。

---

## まとめ

| ポイント | 内容 |
|---------|------|
| 核心原則 | Claudeは検証できる時、劇的に良くなる |
| 基本 | テストケース（入力→期待する出力）を与える |
| UI | スクリーンショットで比較させる |
| バグ修正 | 「根本原因を解決して」と伝える |
| 習慣化 | CLAUDE.md やカスタムコマンドに組み込む |

**覚えておくこと**：

> 検証できないものは、出荷するな。
> （If you can't verify it, don't ship it.）

Claudeに「作って」と頼むだけでなく、「作って、確認して」まで頼む習慣をつけよう。

---

## 次の記事

第3部「CLAUDE.md活用術」では、毎回同じ説明をしなくて済む方法を解説する。

---

## 参考

- [Best Practices - Claude Code Docs（公式）](https://code.claude.com/docs/en/best-practices)
- [Claude Code: Best practices for agentic coding（Anthropic公式ブログ）](https://www.anthropic.com/engineering/claude-code-best-practices)

---

## 関連記事

- [Claude Code インストールガイド（Windows）](claude-code-windows-install-guide)
- [Claude Code 便利機能まとめ：使いこなすためのTips](claude-code-tips-and-features)
- [Claude Code が動かない時に見るページ（Windows）](claude-code-windows-troubleshoot)
