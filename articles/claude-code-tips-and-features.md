---
title: "Claude Codeを使いこなす！知っておきたい便利機能まとめ"
emoji: "⚡"
type: "tech"
topics: ["claudecode", "ai", "生成ai", "llm", "個人開発"]
published: true
---

## 経緯

Claude Codeの基本的な使い方が分かったので、もう少し便利な使い方を試してみた記録。
Subagents（サブエージェント）や並列開発など、知っておくと効率が上がる機能をまとめた。

:::message
**シリーズ構成**
- [非エンジニアがWindowsでClaude Codeを使えるようになるまで](claude-code-windows-install-guide)
- **Claude Codeを使いこなす！知っておきたい便利機能まとめ**（この記事）
- [Claude Codeが動かない時に見るページ（Windows編）](claude-code-windows-troubleshoot)
- [AIにコードを書かせてAIにレビューさせる開発スタイル](claude-code-ai-review-workflow)
- [Claude（Web版）の知識をClaude Codeに引っ越す方法](claude-code-migration-guide)
:::

:::message alert
Claude Codeは頻繁にアップデートされるため、画面や機能が変わっている可能性あり。最新情報は[公式ドキュメント](https://code.claude.com/docs)を確認。
:::

---

## よく使うコマンド一覧

Claude Code の中で使えるコマンド。先頭に `/` をつけて入力する。

### コンテキスト管理（会話の整理）

| コマンド | 説明 | いつ使う？ |
|----------|------|-----------|
| `/clear` | 会話を全部消してリセット | 別の作業を始める時 |
| `/compact` | 会話を要約して短くする | 動作が重くなってきた時 |
| `/context` | 今の会話量を確認 | どれくらい溜まってるか見たい時 |

:::message
**ポイント**
作業が切り替わるたびに `/clear` する習慣をつけると、Claude の精度が落ちにくい。
:::

### コスト管理

| コマンド | 説明 |
|----------|------|
| `/cost` | 今のセッションで使ったトークン（≒お金）を確認 |
| `/model haiku` | 安いモデルに切り替え |
| `/model sonnet` | 標準モデルに切り替え（デフォルト） |
| `/model opus` | 高性能モデルに切り替え（高い） |

### やり直し

| コマンド | 説明 |
|----------|------|
| `/rewind` | 変更を巻き戻す |
| `Esc` キー2回 | 同上（ショートカット） |

Claude が変な変更をしてしまった時に使う。

### セッション管理

| コマンド | 説明 |
|----------|------|
| `/resume` | 過去の会話を再開 |
| `claude -c` | 前回の続きから始める（起動時に使う） |

---

## 便利なキー操作

:::message alert
**注意**
ここで紹介するキー操作は **Claude Code 内** での操作です。
PowerShell 自体の操作とは異なります（後述）。
:::

### サジェスト（予測候補）の選択

Claude がタスクを完了すると、次にやりそうなことがグレーの文字で表示される（サジェスト）。

| キー | 説明 |
|------|------|
| `Tab` | サジェストを受け入れて、編集してから実行 |
| `Enter` | サジェストをそのまま即実行 |

**例：**

```
> hello.txt に「Hello」と書いて

（Claude が実行完了）

> ファイルの中身を確認して    ← グレーで表示される（サジェスト）
```

この状態で `Tab` を押すと、サジェストが入力欄に入り、編集できる。`Enter` を押すとそのまま実行。

### その他のキー操作（Claude Code 内）

| キー | 説明 |
|------|------|
| `Ctrl + C` | Claude Code を終了 |
| `Ctrl + R` | 過去の入力を検索 |
| `Esc` 2回 | 変更を巻き戻すメニューを表示 |
| `↑` キー | 過去の入力履歴を表示 |

### 参考：PowerShell でのキー操作

Claude Code を **起動する前** の PowerShell 画面では、キー操作の意味が異なる。

| キー | PowerShell での動作 |
|------|---------------------|
| `→` キー | グレーのサジェスト（予測）を受け入れる |
| `Tab` | ファイル/フォルダ名の補完候補を順番に表示 |
| `Shift + Tab` | 補完候補を逆順に表示 |
| `Ctrl + Space` | 補完候補の一覧を表示（矢印キーで選択） |
| `↑` キー | 過去に入力したコマンドを表示 |

:::message
**Tab の動作の違い**
- **PowerShell**：`Tab` は補完候補を切り替える。**サジェストは `→` キーで受け入れる**
- **Claude Code**：`Tab` でグレーのサジェストを受け入れる

同じ「グレーの文字」でも、受け入れるキーが違うので注意。
:::

:::message
**Claude Code でファイル名の補完は？**
Claude Code では、ファイル名を直接入力する必要がほとんどない。
「〜ファイルを読んで」「〜フォルダの中身を見せて」と自然に頼めば、Claude が探してくれる。

そのため、PowerShell のような「ファイル名補完」機能は基本的に使わない。
:::

---

## モデルの使い分け

Claude Code では3つのモデルが使える。

| モデル | 特徴 | 向いている作業 | コスト |
|--------|------|----------------|--------|
| **Haiku** | 軽くて速い | ドキュメント作成、簡単な修正 | 安い |
| **Sonnet** | バランス型（デフォルト） | 普通のコーディング | 普通 |
| **Opus** | 高性能 | 難しいバグ調査、複雑な設計 | 高い |

:::message
**迷ったら Sonnet（デフォルト）でOK。** 慣れてきたら使い分けを試してみる。
:::

**使い分けの例：**

```text
/model haiku
README.mdを書いて

（書き終わったら）

/model sonnet
タイマーアプリを作って
```

ドキュメントを書くだけなら Haiku で十分。コストが全然違う。

---

## Subagents（サブエージェント）

Subagents は「専門家チーム」のようなもの。

普段会話している Claude（メインエージェント）から見て、「サブ（補助）」の位置づけで動く別の Claude。

```
+---------------------------+
|  メインエージェント       |  ← 普段会話している Claude
|  （Claude Code 本体）     |
+---------------------------+
       |
       | 「この作業お願い」
       ↓
+---------------------------+
|  サブエージェント         |  ← 専門家として呼び出される
|  （例：コードレビュー担当）|
+---------------------------+
       |
       | 「結果だけ報告」
       ↓
+---------------------------+
|  メインエージェント       |
+---------------------------+
```

### 何がうれしい？

- **別の作業スペース**：メインの会話が散らからない。結果だけ受け取れる
- **制限をかけられる**：「読み取りだけ許可、書き込み禁止」など
- **専門的な指示**：事前に詳しい指示を与えておける

### 設定方法

Claude Code に頼んで作成する：

```
> コードレビュー専用のサブエージェントを作って
```

Claude が `.claude/agents/` フォルダと定義ファイルを自動で作成してくれる。

**生成される例：コードレビュー専用のサブエージェント**

ファイル：`.claude/agents/code-reviewer.md`

```markdown
---
name: code-reviewer
description: コードレビュー専用。セキュリティと品質をチェック。
tools: Read, Grep, Glob
disallowedTools: Write, Edit, NotebookEdit
---

あなたはコードレビューの専門家です。

チェックポイント：
1. セキュリティリスク
2. パフォーマンス問題
3. エラー処理の不備

問題を発見したら、具体的な修正案を提示してください。
```

:::message
**`tools` と `disallowedTools` の違い**
- `tools: Read, Grep, Glob`：このサブエージェントに許可する操作
- `disallowedTools: Write, Edit`：明示的に禁止する操作

両方指定しておくと「読み取り専用」のサブエージェントになる。レビュー担当が勝手にコードを変更しないようにできる。
:::

### グローバルに配置する（全プロジェクトで使う）

一度作ったサブエージェントを、他のプロジェクトでも使いたい場合：

**Windows（PowerShell）:**
```powershell
$claudeDir = "$env:USERPROFILE\.claude"
New-Item -ItemType Directory -Force -Path "$claudeDir\agents\code-reviewer"
Copy-Item ".\.claude\agents\code-reviewer.md" "$claudeDir\agents\code-reviewer\"
```

**macOS / Linux:**
```bash
mkdir -p ~/.claude/agents/code-reviewer
cp .claude/agents/code-reviewer.md ~/.claude/agents/code-reviewer/
```

:::message
**グローバルとローカルの違い**
| 場所 | パス | 用途 |
|------|------|------|
| ローカル | `.claude/agents/` | そのプロジェクトだけで使う |
| グローバル | `~/.claude/agents/` | 全プロジェクトで使える |

スキル（後述のカスタムコマンド）も同様に `~/.claude/skills/` に配置するとグローバルで使える。
:::

### 使い方

設定しておくと、Claude が自動的に判断して使ってくれる。

明示的に使いたい場合：

```text
code-reviewerサブエージェントを使って、この変更をレビューして
```

---

## 並列開発

複数の Claude Code を同時に走らせて、別々の作業をさせる方法。

### やり方

1. **Windows Terminal** を開く（Microsoft Store からインストール推奨）
2. タブを複数開く（Ctrl + Shift + T）
3. **各タブで同じフォルダに移動**してから Claude Code を起動

:::message
**ポイント：同じフォルダで起動する**
両方のタブで同じプロジェクトフォルダに移動してから `claude` を起動する。
そうすると、タブ1 が作ったファイルをタブ2 も読める。
:::

### 具体例：アプリを作りながらレビューしてもらう

先ほど作ったコードレビュー用のサブエージェントを活用する例。

```
+-------------------------------------------+
|            Windows Terminal               |
+---------------------+---------------------+
|       タブ1         |       タブ2         |
|      実装担当       |     レビュー担当    |
+---------------------+---------------------+
|                     |                     |
| > cd ~/my-project   | > cd ~/my-project   |  ← 同じフォルダ
| > claude            | > claude            |
|                     |                     |
| タイマーアプリを    | さっき作ったコードを|
| 作って              | レビューして        |
|                     |                     |
+---------------------+---------------------+
         ↓                     ↓
   ファイルを作成        そのファイルを読んでレビュー
```

**流れ：**

1. 両方のタブで同じフォルダに移動して `claude` を起動
2. タブ1 でコードを書く
3. ある程度できたら、タブ2 でレビューを依頼（タブ1が作ったファイルを読める）
4. 指摘があればタブ1 で修正
5. 繰り返し

### 注意点

- **同じファイルを同時に編集させない**（競合する）
- コストは倍になる
- 急いでいない時は1つで十分

---

## カスタムコマンド

よく使う指示を「コマンド」として登録できる。

### 設定方法

Claude Code に頼んで作成する：

```
> /test と入力したら npm test を実行するカスタムコマンドを作って
```

Claude が `.claude/commands/` フォルダと定義ファイルを自動で作成してくれる。

**生成される例：テスト実行コマンド**

ファイル：`.claude/commands/test.md`

```markdown
---
description: テストを実行して結果を報告
---

npm test を実行してください。
失敗したテストがあれば、原因を分析して修正案を提示してください。
```

### 使い方

```text
/test
```

これだけで、上で定義した指示が実行される。

---

## 確認を省略する設定（Auto-accept）

Claude Code は安全のため、ファイル編集やコマンド実行のたびに確認を求めてくる。
これが煩わしい場合、確認を省略する設定ができる。

### 方法1：その場で一時的に切り替える（おすすめ）

Claude Code の画面で **Shift + Tab** を押すと、モードが切り替わる。

| モード | 表示 | 動作 |
|--------|------|------|
| **通常モード** | （表示なし） | 毎回確認を求める |
| **Auto-accept** | `auto-accept edit on` | ファイル編集を自動で許可 |
| **Plan モード** | `plan mode on` | 読み取り専用（調査・計画用） |

**Shift + Tab** を押すたびにモードが順番に切り替わる。

:::message
**ポイント**
慣れるまでは通常モードで確認しながら作業し、「この作業は大丈夫」と分かってきたら Auto-accept に切り替えるのがおすすめ。
:::

### 方法2：設定ファイルで指定する

毎回同じ設定を使いたい場合、設定ファイルに書いておける。

Claude Code に頼んで作成する：

```
> 設定ファイルを作成して、ファイル編集は自動で許可するようにして
```

または手動で作成する場合：

**ファイル**：`~/.claude/settings.json`（全プロジェクト共通）

```json
{
  "permissions": {
    "defaultMode": "acceptEdits"
  }
}
```

:::message
**設定ファイルの場所**
| 場所 | パス | 用途 |
|------|------|------|
| 全プロジェクト共通 | `~/.claude/settings.json` | 自分の全作業に適用 |
| プロジェクトごと | `.claude/settings.json` | そのフォルダだけに適用 |
:::

### 方法3：特定のコマンドだけ許可する

「npm のコマンドだけ自動で許可したい」のような場合：

```json
{
  "permissions": {
    "allow": [
      "Bash(npm run:*)",
      "Bash(npm test:*)"
    ]
  }
}
```

:::message
**ワイルドカードの意味**
- `npm run:*` → 「npm run」で始まるコマンドを全て許可
- `*` → 何でもマッチする記号
:::

### 安全上の注意

:::message alert
**注意：確認を省略するとリスクも増える**
- Claude が間違ったファイルを編集しても、気づかないまま進む可能性がある
- 大事なファイルを消してしまうかもしれない
- 必ず **Git でこまめにコミット**して、戻れる状態を保つこと
:::

**やってはいけないこと：**

- `--dangerously-skip-permissions` フラグは使わない（全ての確認を無視するため危険）
- よく分からないプロジェクトで Auto-accept を使わない
- `.env` や認証情報が入ったファイルがあるフォルダで Auto-accept を使わない

---

## コスト管理のコツ

### 1. `/clear` をこまめに使う

会話が長くなると、毎回大量のトークンを消費する。作業が切り替わったら `/clear`。

### 2. モデルを使い分ける

| 作業 | モデル |
|------|--------|
| ドキュメント作成 | Haiku |
| 普通のコーディング | Sonnet |
| 難しい問題 | Opus |

### 3. `/cost` で確認する習慣

```text
/cost
```

今のセッションでいくら使ったか見える。高くなってきたら `/clear` してリセット。

---

## 参考

- [Claude Code Best Practices（公式）](https://code.claude.com/docs/en/best-practices)
- [Subagents ドキュメント（公式）](https://code.claude.com/docs/en/sub-agents)
- [Settings ドキュメント（公式）](https://code.claude.com/docs/en/settings)

---

## 関連記事

- [非エンジニアがWindowsでClaude Codeを使えるようになるまで](claude-code-windows-install-guide)
- [Claude Codeが動かない時に見るページ（Windows編）](claude-code-windows-troubleshoot)
- [AIにコードを書かせてAIにレビューさせる開発スタイル](claude-code-ai-review-workflow)
- [Claude（Web版）の知識をClaude Codeに引っ越す方法](claude-code-migration-guide)
