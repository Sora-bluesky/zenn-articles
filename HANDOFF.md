# HANDOFF - zenn-articles

> 最終更新: 2026-01-31

---

## 次のセッションへの引き継ぎ

### 記事ネタ: Claude Code Orchestra を自分なりにカスタマイズしてみた

**ステータス**: 記事執筆待ち（優先度: 高）

#### 記事タイトル案

- 「Claude Code Orchestra をカスタマイズして情報発信CLIを作ってみた」
- 「オートレビュー機能を追加して "別タブで/review" から解放された話」
- 「3エージェント協調で情報発信ツールを作る：Orchestra実践ガイド」
- 「参考記事を読んで終わりにしない：自分なりのOrchestraを構築した話」

#### 参考記事

- [Claude Code Orchestra](https://zenn.dev/mkj/articles/claude-code-orchestra_20260120) - 松尾研究所 Taisei Ozaki氏
- [Claude Code Hooksの深い活用](https://zenn.dev/zaico/articles/d6b882c78fe4b3) - ZAICO

#### 記事コンセプト

**テーマ**: 自分なりにカスタマイズしたorchestraで、実際に情報発信ツールを作ってみた

**記事の形式**:
- **実践チュートリアル** + スクショを織り交ぜた解説
- 「カスタマイズした」だけでなく「実際に使ってみた」まで見せる

**差別化ポイント**:
- 参考記事の「完成形」をそのまま使うのではなく、**自分なりにカスタマイズ**
- さらに**実際にツールを作る過程**をスクショ付きで紹介
- 情報発信フローを効率化する実用的なツールをサンプルに
- **「どんなアプリを作りますか？」的な会話からスタート**（対話型セットアップ）
- **オートレビューのレベルを選択できる**（全自動 / 通知のみ）
- **スキル自動生成は公式ベストプラクティスに準拠**（Progressive Disclosure設計）

**自分なりの工夫（カスタマイズ内容）**:
1. **オートレビュー機能の追加**（auto-review-fix.py）
   - 参考記事にはなかったPostToolUseフックによる自動レビュー
   - 変更閾値超えでCodex自動レビュー
   - blocking問題の自動修正ループ（最大3回）

2. **スキル自動生成の追加**
   - 元の参考記事はHooks中心（12ファイル）
   - 開発フロー系スキル6つも自動生成（18ファイルに拡張）
   - プロジェクトローカルに生成してカスタマイズ性を担保

**サンプルアプリ: 情報発信パイプライン管理CLIツール**

Notion APIを活用した情報発信の一元管理ツール。

**主な機能**:
1. **マークダウン → X用プレーンテキスト変換**
   - 太字・リンク・箇条書き等の記号除去
   - 280文字カウント

2. **Notionデータベースでステータス管理**
   - 下書き / 確認待ち / 投稿済

3. **Obsidianからの原稿取り込み**

**出力先**:
| プラットフォーム | 投稿方法 |
|-----------------|---------|
| X | 手動コピペ |
| Zenn | CLI自動化済み |
| note | ブラウザ自動化で投稿 |

#### 記事構成案

1. **導入**
   - 2つの参考記事との出会い
   - 「カスタマイズして、実際に使ってみよう」という動機

2. **参考記事の概要**
   - Claude Code Orchestra（松尾研究所）: 3エージェント協調、Hooks自動提案
   - Hooksの深い活用（ZAICO）: 状態永続化、自己修正メカニズム

3. **カスタマイズ内容**
   - **オートレビュー機能の追加**
     - 「別タブで/reviewを回す」から解放
     - auto-review-fix.py の仕組み
   - **スキル自動生成の追加**
     - 12ファイル → 18ファイルに拡張
     - プロジェクトローカル配置の設計判断

4. **実践: 情報発信CLIツールを作ってみる** ⭐ メインコンテンツ
   - **4.1 /orchestra でセットアップ**（スクショ）
     - 質問に答える様子
     - 生成された18ファイル一覧
   - **4.2 /startproject でプロジェクト開始**（スクショ）
     - 「Notion API + CLIツール」でGeminiリサーチ
     - 「マークダウン変換 + ステータス管理」の計画をCodexレビュー
   - **4.3 実装: 3つの主要機能**（スクショ）
     - MD→X変換（記号除去、280文字カウント）
     - Notionデータベース連携（ステータス管理）
     - Obsidian原稿取り込み
   - **4.4 オートレビューが動く様子**（スクショ）
     - 自動でCodexレビューが走る
     - blocking問題の検出・修正
   - **4.5 /checkpointing で状態保存**（スクショ）

5. **完成したCLIツール**
   - 動作デモ（スクショ or GIF）
   - コマンド例:
     ```bash
     publish-cli import --from obsidian --file "記事.md"
     publish-cli convert --to x --count
     publish-cli status --update "確認待ち"
     ```

6. **まとめ**
   - カスタマイズして自分のものにする価値
   - 実際に使ってみて気づいたこと
   - 次に試したいこと

#### スクショ撮影ポイント

| 場面 | 撮影内容 |
|------|---------|
| /orchestra 実行 | 質問ダイアログ（プロジェクトタイプ、自動修正モード） |
| セットアップ完了 | 生成された18ファイル一覧（.claude/skills, .claude/hooks） |
| /startproject | Gemini「Notion API調査」、Codex「計画レビュー」 |
| MD変換実装 | 記号除去、280文字カウント機能のコード |
| Notion連携実装 | データベースAPI呼び出し、ステータス更新 |
| オートレビュー発火 | 「🔍 3回変更検出。Codexでレビュー中...」のログ |
| 自動修正 | 「🔴 blocking問題を検出」→「✅ 修正完了」 |
| /checkpointing | チェックポイントファイル生成 |
| 完成CLI | `publish-cli convert --to x` の実行結果 |

#### 記事執筆の手順

1. **アプリ作成を先に実施**（スクショを撮りながら）
   - 新規プロジェクトで /orchestra を実行
   - /startproject で開始
   - 実装中にスクショを撮影
   - /checkpointing で状態保存

2. **記事執筆**
   - スクショを整理
   - 各セクションを執筆
   - コードハイライトを追加

3. **レビュー**
   - /zenn-quality でチェック
   - /fact-check で参照記事の引用確認

#### 実際のやり取り記録

**セッション概要**:
- 日付: 2026-01-31
- やり取り回数: 約10回
- 主要なターニングポイント: メタ認知レビューでの方針転換

**主要なやり取り**:

1. 「参考記事を読んで、orchestraセットアップ機能を実装したい」
   → 基本構成を理解、12ファイル生成版の設計開始

2. 「別タブでレビューを回すのが面倒。自動化できないか？」
   → **auto-review-fix.py を追加**（自分なりの工夫①）
   → PostToolUseフックで変更を監視、閾値超えでCodex自動レビュー

3. 「開発フロー系スキルもセットアップで自動生成したい」
   → スキルをグローバルに移行？ → メタ認知レビューで「間違い」と判断
   → **プロジェクトローカルに生成する設計**に変更（自分なりの工夫②）

4. 「skill-templates.mdを作成」
   → 6スキルのテンプレートを記載
   → 18ファイル生成版に拡張完了

5. 「Obsidianのコマンド・スキル一覧を更新」
   → 「orchestraで自動生成可能」と注記

**自分なりの工夫のポイント**:

**工夫①: オートレビュー機能（auto-review-fix.py）**
- 参考記事にはなかった機能
- 変更閾値（3回）を超えるとCodexで自動レビュー
- blocking問題を検出したら自動修正（最大3回ループ）
- 「別タブで/reviewを回す」必要がなくなった

**工夫②: スキル自動生成（12→18ファイル）**
- 元の参考記事はHooks 6ファイル + 設定 6ファイル = 12
- 開発フロー系スキル6つを追加生成
- プロジェクトローカルに配置してカスタマイズ性を担保

**ターニングポイント**: メタ認知レビュー

当初、sakura-techoにある開発フロー系スキルを `~/.claude/skills/` にグローバル移行しようと考えた。
しかしメタ認知レビューで：
- グローバル化するとプロジェクト固有のカスタマイズが困難
- `/orchestra` がセットアップ時に**プロジェクトローカルに生成**すれば問題解決

この気づきにより、スキルも自動生成する設計に変更。

#### 技術的なポイント（記事で解説）

| 項目 | 内容 |
|------|------|
| 生成ファイル数 | 18（Hooks 6 + スキル 6 + 設定 6） |
| **オートレビュー** | PostToolUseフック、変更閾値3、自動修正ループ最大3回 |
| スキル配置 | プロジェクトローカル（.claude/skills/） |
| カスタマイズ | CUSTOMIZE.md で案内 |
| tdd のプレースホルダー | `{TEST_COMMAND}` をプロジェクトに合わせて設定 |

**オートレビューの設定（.orchestra/config.json）**:
```json
{
  "auto_review": {
    "enabled": true,
    "change_threshold": 3,
    "auto_fix_enabled": true,
    "max_fix_loops": 3
  }
}
```

#### 関連ファイル

| ファイル | 場所 |
|---------|------|
| SKILL.md | `~/.claude/skills/orchestra/SKILL.md` |
| skill-templates.md | `~/.claude/skills/orchestra/references/skill-templates.md` |
| hooks-examples.md | `~/.claude/skills/orchestra/references/hooks-examples.md` |
| コマンド・スキル一覧 | Obsidian |

---

## 未着手の記事ネタ

| ネタ | 優先度 | メモ |
|------|--------|------|
| MCP設定のベストプラクティス | 中 | `~/.claude.json` vs `.mcp.json` の使い分け |
| Claude Code + Obsidian 連携 | 高 | MCP経由でのノート操作 |

---

## 前回のセッションサマリ

（なし - 新規作成）
