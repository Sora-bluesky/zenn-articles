<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 560 780" width="560" height="780">
  <defs>
    <style>
      text { font-family: 'Segoe UI', 'Meiryo', sans-serif; fill: #ffffff; }
      .label { font-size: 13px; font-weight: bold; }
      .sublabel { font-size: 11px; fill: #cccccc; }
      .arrow-label { font-size: 13px; font-weight: bold; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#aaaaaa"/>
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e67e22"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#27ae60"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect x="0" y="0" width="560" height="780" rx="12" fill="#1a1a2e"/>

  <!-- Title -->
  <text x="280" y="32" text-anchor="middle" font-size="15" font-weight="bold" fill="#ffffff">自動レビューサイクル</text>

  <!-- 1. Start: User instruction -->
  <rect x="160" y="50" width="240" height="44" rx="22" fill="#27ae60"/>
  <text x="280" y="70" text-anchor="middle" class="label">ユーザー</text>
  <text x="280" y="86" text-anchor="middle" class="sublabel">「機能Xを作って」</text>

  <!-- Arrow 1→2 -->
  <line x1="280" y1="94" x2="280" y2="120" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 2. Process: Antigravity creates code -->
  <rect x="160" y="120" width="240" height="44" rx="8" fill="#2980b9"/>
  <text x="280" y="147" text-anchor="middle" class="label">Antigravity: コード作成</text>

  <!-- Arrow 2→3 -->
  <line x1="280" y1="164" x2="280" y2="190" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 3. Process: git commit -->
  <rect x="160" y="190" width="240" height="44" rx="8" fill="#2980b9"/>
  <text x="280" y="217" text-anchor="middle" class="label">git commit</text>

  <!-- Arrow 3→4 -->
  <line x1="280" y1="234" x2="280" y2="260" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 4. Process: review.ps1 -->
  <rect x="160" y="260" width="240" height="44" rx="8" fill="#2980b9"/>
  <text x="280" y="287" text-anchor="middle" class="label">review.ps1 実行</text>

  <!-- Arrow 4→5 -->
  <line x1="280" y1="304" x2="280" y2="330" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 5. Process: Codex review -->
  <rect x="130" y="330" width="300" height="44" rx="8" fill="#8e44ad"/>
  <text x="280" y="357" text-anchor="middle" class="label">Codex: レビュー結果（🔴🟡🟢💡）</text>

  <!-- Arrow 5→6 -->
  <line x1="280" y1="374" x2="280" y2="410" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- 6. Decision: Critical issues? (diamond) -->
  <polygon points="280,410 410,465 280,520 150,465" fill="#f39c12" stroke="#e67e22" stroke-width="2"/>
  <text x="280" y="460" text-anchor="middle" class="label" fill="#1a1a2e">🔴 重大 あり？</text>
  <text x="280" y="477" text-anchor="middle" font-size="10" fill="#1a1a2e">（または 🟡 注意）</text>

  <!-- Arrow: Yes (left) → Fix -->
  <line x1="150" y1="465" x2="80" y2="465" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="116" y="453" text-anchor="middle" class="arrow-label" fill="#e74c3c">Yes</text>

  <!-- Arrow: No (down) → Done -->
  <line x1="280" y1="520" x2="280" y2="560" stroke="#aaaaaa" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="300" y="545" text-anchor="start" class="arrow-label" fill="#27ae60">No</text>

  <!-- 7a. Fix (left side) -->
  <rect x="20" y="490" width="120" height="56" rx="8" fill="#e67e22"/>
  <text x="80" y="515" text-anchor="middle" class="label">修正</text>
  <text x="80" y="534" text-anchor="middle" class="sublabel">（最大5回）</text>

  <!-- Loop arrow: Fix → git commit (up left side, then right) -->
  <line x1="80" y1="490" x2="80" y2="212" stroke="#e67e22" stroke-width="2" stroke-dasharray="6,3"/>
  <line x1="80" y1="212" x2="158" y2="212" stroke="#e67e22" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowhead-orange)"/>
  <text x="92" y="355" class="sublabel" fill="#e67e22" font-size="11" font-weight="bold">ループ</text>

  <!-- 7b. Done (below decision) -->
  <rect x="210" y="562" width="140" height="44" rx="22" fill="#27ae60"/>
  <text x="280" y="589" text-anchor="middle" class="label">✅ 完了報告</text>

  <!-- Return arrow: Done → User (right side, going up) -->
  <line x1="350" y1="584" x2="490" y2="584" stroke="#27ae60" stroke-width="2" stroke-dasharray="6,3"/>
  <line x1="490" y1="584" x2="490" y2="72" stroke="#27ae60" stroke-width="2" stroke-dasharray="6,3"/>
  <line x1="490" y1="72" x2="402" y2="72" stroke="#27ae60" stroke-width="2" stroke-dasharray="6,3" marker-end="url(#arrowhead-green)"/>
  <text x="502" y="330" text-anchor="start" font-size="10" fill="#27ae60" font-weight="bold">報告</text>

  <!-- Legend -->
  <rect x="30" y="640" width="500" height="120" rx="8" fill="#252545" stroke="#3a3a5e" stroke-width="1"/>
  <text x="280" y="664" text-anchor="middle" font-size="12" font-weight="bold" fill="#cccccc">凡例</text>
  <rect x="50" y="680" width="16" height="12" rx="6" fill="#27ae60"/>
  <text x="74" y="691" font-size="11" fill="#cccccc">開始 / 終了</text>
  <rect x="190" y="680" width="16" height="12" rx="3" fill="#2980b9"/>
  <text x="214" y="691" font-size="11" fill="#cccccc">処理</text>
  <rect x="300" y="680" width="16" height="12" rx="3" fill="#8e44ad"/>
  <text x="324" y="691" font-size="11" fill="#cccccc">AI レビュー</text>
  <polygon points="58,714 66,708 74,714 66,720" fill="#f39c12"/>
  <text x="84" y="718" font-size="11" fill="#cccccc">判定</text>
  <rect x="190" y="708" width="16" height="12" rx="3" fill="#e67e22"/>
  <text x="214" y="718" font-size="11" fill="#cccccc">修正ループ</text>
  <line x1="310" y1="714" x2="340" y2="714" stroke="#e67e22" stroke-width="2" stroke-dasharray="6,3"/>
  <text x="348" y="718" font-size="11" fill="#cccccc">ループ矢印</text>
  <text x="280" y="748" text-anchor="middle" font-size="10" fill="#888888">🔴 重大 と 🟡 注意 がゼロになるまで自動で繰り返す</text>
</svg>
